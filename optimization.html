

    <section class="main-content">
      <h2>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a><b>Optimization Constraints Design</b></h2>
<p>We assume that a transition process is good if the robot is stable in the whole process.
The robot’s center of mass is expected to be maintained in the supported polygon if we want it to appear stable. In the current situation, the robot is like:
</p>
<p>
<div class = "box" align= "center">
   <img src="img/robot.png" />
</div>
</p>
<p>It would be a lot easier for the robot to remain stable when moving forward/backward rather than moving left/right:
</p>
<p>
<div class = "box" align= "center">
   <img src="img/forward_right.png" />
</div>
</p>
<p></p>
<p>Basically for an arbitrary robot, it would be more stable for it to move along its long axis (the axis on which it has the longest length) than the short one. Focused on the movements of the center of mass and its relative positions to the supported polygons at different time sample points, I came up with the following factors which may affect the stability of the transition process:
</p>
<p></p>
<h3>Sequence of limb</h3>

<p>Since we want the center of mass to stay in the supported polygon, let’s first assume that we have at most one limb in the air at a time. We would later discuss the situations of more than 2 limbs.
</p>
<p></p>
<p>We then would have 5 states of the robot:
</p>
<p></p>
<li><b>State1: Front left limb (1) lifted:</b></li>
<p>
<div class = "box" align= "center">
   <img src="img/rb1.png" />
</div>
</p>
<p></p>
<li><b>State2: Back left limb (2) lifted:</b></li>
<p>
<div class = "box" align= "center">
   <img src="img/rb2.png" />
</div>
</p>
<p></p>
<li><b>State3: Front right limb (3) lifted:</b></li>
<p>
<div class = "box" align= "center">
   <img src="img/rb3.png" />
</div>
</p>
<p></p>
<li><b>State4: Back right limb (4) lifted:</b></li>
<p>
<div class = "box" align= "center">
   <img src="img/rb4.png" />
</div>
</p>
<p></p>
<li><b>State5: Stance:</b></li>
<p>
<div class = "box" align= "center">
   <img src="img/stance.png" />
</div>
</p>
<p></p>
<p>The transferring from one state to another among the first 4 states would cause the robot’s center of mass to move as follows:
</p>
<p>
<div class = "box" align= "center">
   <img src="img/table1.png" />
</div>
</p>
<p></p>
<p>
<li><b>Moving backward to moving forward</b></li>
</p>
<p>I then tested a few state sequence on the transition between the motion plan of migrating backward and the motion plan of migrating forward.
</p>
<p></p>
<p>My assumption is that the robot would prefer those state transfers moving forward/backward than those moving left/right based on the following two reasons:
</p>
<li>As is mentioned above, moving forward/backward is more stable than moving left/right;
</li>
<li>The target of the transition is just to change the moving forward speed. It may cause disturbance if we move left/right a lot in the whole process.
</li>
<p></p>
<p>I thus designed the following scored table based on the assumptions:
</p>
<p>
<div class = "box" align= "center">
   <img src="img/table2.png" />
</div>
</p>
<p></p>
<p>The smaller the total score is, the better we predict the transition. Moving (forward/backward)&(left/right) get 1.5 because it has one advantage: moving forward/backward and two disadvantages: moving left/right and moving a longer distance than the other two.
</p>
<p></p>
<p>The smaller the total score is, the better we predict the transition. Moving (forward/backward)&(left/right) get 1.5 because it has one advantage: moving forward/backward and two disadvantages: moving left/right and moving a longer distance than the other two.
</p>
<p></p>
<p>We then have:
</p>
<p>
<div class = "box" align= "center">
   <img src="img/table3.png" />
</div>
</p>
<p></p>
<p>Here are the designed transitions and the predicted scores. Notice that we also add one footfall pattern state from motion plan 1 and motion plan 2 respectively to monitor the process between the transition and the motion plans.
</p>
<p>
<div class = "box" align= "center">
   <img src="img/table4.png" />
</div>
</p>
<p></p>
<p>The results are as follows:
</p>
<p></p>
<p>F1: (State4)->State1->State2->State3->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/F1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/Zr4njNKXhA0?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>G1: (State4)->State1->State3->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/G1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/oTTxavdAiEE?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>H1: (State4)->State1->State4->State2->State3->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/H1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/mKJVuy4GXHY?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>L1: (State2)->State3->State4->State1->State2->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/L1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/q3Bv3IB-Dow?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>M1: (State2)->State3->State2->State1->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/M1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/ffauS1_7Vg4?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>N1: (State2)->State3->State1->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/N1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/yevK0D1BKLI?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>One thing to notice is that G and H get the same score, but H behaves worse than G. N scores more than M but behaves better.
</p>
<p></p>
<p>We then find that both H and M have two continuous (forward/backward)&(left/right) transfers(H has (State4)->State1->State4; M has (State2)->State3->State2 and State1->State4->State1) which affect the stability of the robot(the robot is supposed to have a big acceleration to change its velocity), and thus add a 1 score penalty if two same state transfers appear together. We then have:
</p>
<p>
<div class = "box" align= "center">
   <img src="img/table5.png" />
</div>
</p>
<p></p>
<p>
<li><b>Moving forward & turning left to moving forward</b></li>
</p>
<p>
I tested those state sequence on the transition between the motion plan of migrating forward & turning left and the motion plan of migrating forward at last. The results are almost the same as above, except that we need to take the speed changes on the short axis into consideration. For example, when the robot starts to transit from motion plan one, it has an initial speed of turning left. If, at the beginning part of the transition, we still let its center of mass to move to the left side, selecting State 3 or State 4, for example, the robot would probably be unstable. We could take a look at the following examples:
</p>
<h3>I2: (State2)->State3->State4->State1->State2->State1->(State2)
</h3>
<p>
<div class = "box" align= "center">
   <img src="img/L1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/m5sTbaSnVTA?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<h3>J2: (State2)->State3->State2->State1->State4->State1->(State2)</h3>
<p>
<div class = "box" align= "center">
   <img src="img/M1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/5H4Yx1HL-L8?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<h3>K2: (State2)->State3->State1->State2->State4->State1->(State2)
</h3>
<p>
<div class = "box" align= "center">
   <img src="img/N1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/411Gej44fFk?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>
Compared with the same footfall patterns from moving backward to moving forward:
</p>
<p>L1: (State2)->State3->State4->State1->State2->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/L1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/q3Bv3IB-Dow?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>M1: (State2)->State3->State2->State1->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/M1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/ffauS1_7Vg4?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>N1: (State2)->State3->State1->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/N1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/yevK0D1BKLI?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>We thus need to carefully pick up the constraints in the motion plans which have right/left speed. One solution is to pick up those time sample points where the robot’s center of mass moves to the opposite direction. In this case, the robot has an initial left speed, so we could pick State1 or State2, which balance the robot’s speed to right a bit, as the initial constraint:
</p>
<p>O2: (State1)->State2->State1->State4->State3->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/O2.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/R1yAXKgd1pA?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>P2: (State1)->State2->State3->State1->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/P2.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/lUYY-r5QxXg?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>Q2: (State1)->State2->State4->State1->State3->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/Q2.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/dG5Zin-pNA0?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>If we have to use the constraints from the other 2 states, shorten the length of the corresponding swing period in transition:
</p>
<p>L2: (State2)->State3->State4->State1->State2->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/L2.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/-jmrEdXtYDE?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>M2: (State2)->State3->State2->State1->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/M2.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/7l00cehEWGQ?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<p>N2: (State2)->State3->State1->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/N2.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/Du2xUw06-Z4?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>
<h3>
<a id="designer-templates" class="anchor" href="#designer-templates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Number of continuous swing time sample points
</h3>
<p>The examples we used above have only two continuous swing time sample points for each state. The longer one state lasts, the more the robot will move to the corresponding supported polygon. The robot will face a different supported polygon in the next state, and this means that the robot is supposed to move more during the state transfer period to remain stable if the state transfer is left/right or (forward/backward)&(left/right). More swing time sample points could also imply less stance states. Both of the situations indicate the possibility of instability. We could have a look at one of the examples:
</p>
<p></p>
<p>G1: (State4)->State1->State3->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/G1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/oTTxavdAiEE?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>

<p>J1: (State4)->State1->State3->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/J1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/P0pjTNuU5iA?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>

<h3>
<a id="rather-drive-stick" class="anchor" href="#rather-drive-stick" aria-hidden="true"><span class="octicon octicon-link"></span></a>Number of stance states between two swing states
</h3>
<p>We have at least one stance time sample point between two swing states in the examples of 1. Stance states provide more state transfer time and therefore is helpful to keeping the whole process’s stability. Here is one of the examples:
</p>
<p></p>
<p>G1: (State4)->State1->State3->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/G1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/oTTxavdAiEE?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>

<p>Q: (State4)->State1->State3->State2->State4->State1->(State2)
</p>
<p>
<div class = "box" align= "center">
   <img src="img/Q1.png" />
</div>
</p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/8MEOXRpfRvI?rel=0" frameborder="0" allowfullscreen></iframe>
<p></p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion
</h3>
<p>To sum up, we want a transition which:
</p>
<li>Uses as few left/right states as possible, and scores high in the limb sequence test;
</li>
<li>Has as few continuous swing time sample points for each state as possible;
</li>
<li>Has a stance state after each continuous swing period. Remove the stance states on forward/backward state transfer periods if have to delete some.
</li>
<p></p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implementation
</h3>
<p>We pickup the best footfall pattern based on the following steps:
</p>
<li>Add constraints;</li>
<li>Generate .cnf files so that the candidate footfall patterns:</li>
<p>1) have at most one swing limb at every time sample point;</p>
<p>2) do not have single swing point for each limb;</p>
<p>3) have at least one swing point for each limb;</p>
<p>4) have a all-stance time sample point after each swing period;</p>
<li>Use <a href ="http://www.cs.rochester.edu/u/kautz/walksat/">Walksat</a> to generate 10 candidate footfall patterns. Score, rank, and assign the best result to the current footfall pattern.</li>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a name="ref"></a></h3>
<ol>1. "Local Search Strategies for Satisfiability Testing."  Bart Selman, Henry Kautz, and Bram Cohen.</ol>

      <footer class="site-footer">
      <span class="site-footer-owner"><a href="https://github.com/sushuang9210/FootfallPatternTransitionOptimization">Footfall Pattern Transition Optimization</a> is maintained by <a href="https://github.com/sushuang9210">Shuang Su</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>
